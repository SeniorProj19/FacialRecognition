Create Database OrbitLens;
Use OrbitLens;

CREATE USER 'ClearOrbit' IDENTIFIED BY 'SeniorProject2019';
GRANT SELECT, INSERT, UPDATE, DELETE ON orbitlens.* to 'ClearOrbit';

ALTER USER 'ClearOrbit'
 IDENTIFIED WITH mysql_native_password BY 'SeniorProject2019';

DROP TABLE IF EXISTS relations;
DROP TABLE IF EXISTS photos;
DROP TABLE IF EXISTS information;
DROP TABLE IF EXISTS login_info;

CREATE TABLE login_info(
	user_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    username VARCHAR(45) NOT NULL,
    password VARCHAR(100) NOT NULL,
    PRIMARY KEY(user_id)
    );
    
    
CREATE TABLE information(
	user_id INT UNSIGNED NOT NULL,
	first_name VARCHAR(45),
    last_name VARCHAR(45),
    profile_pic LONGBLOB NOT NULL,
    email VARCHAR(100), 
    job_title VARCHAR(45),
    about_me VARCHAR(500),
    age INT, 
    birthday DATETIME,
    phone_number VARCHAR(12),
    resume LONGBLOB,
    education VARCHAR(45),
    position VARCHAR(45),
    hometown VARCHAR(45),
    curr_company VARCHAR(45),
    PRIMARY KEY (user_id),
    FOREIGN KEY (user_id) REFERENCES login_info(user_id)
);
    
CREATE TABLE photos(
	photo_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    photo LONGBLOB,
    user_id INT UNSIGNED NOT NULL,
    PRIMARY KEY (photo_id),
    FOREIGN KEY (user_id) REFERENCES information(user_id)
);
    
CREATE TABLE relations(
	relation_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    user_id INT UNSIGNED NOT NULL,
    paired_user INT UNSIGNED NOT NULL,
    favorite BOOLEAN,
    time_matched DATETIME,
    PRIMARY KEY (relation_id),
    FOREIGN KEY (user_id) REFERENCES information(user_id),
	FOREIGN KEY (paired_user) REFERENCES information(user_id)
);


INSERT INTO login_info(username, password) VALUES ('sirajs8', 'thisisapassword1234');
INSERT INTO login_info(username, password) VALUES ('does this work', 'yes it does');
DELETE FROM login_info WHERE user_id = 1;
INSERT INTO login_info(username, password) VALUES ('first one should be gone', 'damn');
INSERT INTO login_info(username, password) VALUES ('continue', 'sure why not');
DROP TABLE relations;
DROP TABLE photos;
DROP TABLE information;
DROP TABLE login_info;

SELECT * FROM login_info WHERE username = 's';
SELECT * FROM login_info;

DELETE FROM login_info WHERE user_id = 1;

SELECT * FROM login_info;

